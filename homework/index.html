<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      body {
        text-align: center;
      }
      #pack {
        margin-left: 100px;
      }

      table {
        border-collapse: collapse;
        margin-left: auto;
        margin-right: auto;
      }

      td {
        border: 1px solid black;
        width: 200px;
        height: 30px;
        text-align: center;
      }
    </style>
  </head>
  <body>
    <form>
      <label>
        이름
        <input type="text" id="name" />
      </label>
      <label
        >부서
        <input list="departmentList" id="department" />
        <datalist id="departmentList">
          <option>경영관리</option>
          <option>국내물류</option>
          <option>해외물류</option>
        </datalist>
      </label>
      <label
        >입사일
        <input type="date" id="join" />
      </label>
      <label
        >이메일
        <input type="userEmail" id="email" />
      </label>
      <label id="pack"
        >검색
        <input type="text" id="search" />
        <input type="submit" value="등록" id="make" />
        <button id = "resetBtn">초기화</button>
      </label>
    </form>
    <p></p>
    <table id="table">
      <tr>
        <td>이름</td>
        <td>부서</td>
        <td>입사일</td>
        <td>근속일수</td>
        <td>이메일</td>
        <td>수정</td>
        <td>삭제</td>
      </tr>
    </table>
    <script>
      const $names = document.querySelector("#name");
      const $department = document.querySelector("#department");
      const $join = document.querySelector("#join");
      const $email = document.querySelector("#email");
      const $make = document.querySelector("#make");
      const $table = document.querySelector("#table");
      const $reset = document.querySelector("#resetBtn");
      let names;
      let department;
      let join;
      let email;
      let pack = [];

        $reset.addEventListener("click",()=>{
            for (let i = 0; i < $table.childNodes.length; i++){
                if ($table.childNodes[i] === "tr"){
                    $table.childNodes[i].remove();
                }
            }
        });
      $names.addEventListener("input", function (event) {
        names = event.target.value;
      });
      $department.addEventListener("input", (event) => {
        department = event.target.value;
      });
      $join.addEventListener("input", (event) => {
        join = event.target.value;
      });
      $email.addEventListener("input", (event) => {
        email = event.target.value;
      });

      $make.addEventListener("click", (event) => {
        event.preventDefault(); //새로고침 방지
        if ($names.value != false && $department.value != false && $join.value != false){
          pack.push(names);
        pack.push(department);
        pack.push(join);
        pack.push("");
        pack.push(email);
        const $btn2 = document.createElement("button");
        $btn2.textContent = "삭제";
        const $btn1 = document.createElement("button");
        $btn1.textContent = "수정";
        for (let i = 0; i < 1; i++) {
          const $tr = document.createElement("tr");
          for (let j = 0; j < 7; j++) {
            const $td = document.createElement("td");
            $td.textContent = pack[j];
            if (j === 3) {
              let now = new Date();
              let year = now.getFullYear();
              let month = now.getMonth() + 1;
              let day = now.getDate();
              let endTime = new Date(year, month, day);
              let aa = join.slice(0, 4); //입사일(년)
              let bb = join.slice(5, 7); //입사일(월)
              let cc = join.slice(8, 10); //입사일(일)
              let startTime = new Date(aa, bb, cc);
              let btMs = endTime.getTime() - startTime.getTime();
              let btDay = btMs / (1000 * 60 * 60 * 24);
              $td.textContent = btDay;
            }else if(j === 5) {
                $td.append($btn1);
            }else if (j === 6) {
              $td.append($btn2);
            }
            $tr.appendChild($td);
          }
          $table.appendChild($tr);
        }
        $names.value = "";
        $department.value = "";
        $join.value = "2022-05-20";
        $email.value = "";
        pack = [];
        $btn2.addEventListener("click", (event) => {
          event.target.parentElement.parentElement.remove();
        });
        $btn1.addEventListener("click", (event)=>{
          console.log(event.target.parentElement.parentElement.childNodes[1]);
          for (let i = 0; i < 3; i++){
            if (i === 0){
              $names.value = event.target.parentElement.parentElement.childNodes[i].textContent;
            }else if (i === 1){
              $department.value = event.target.parentElement.parentElement.childNodes[i].textContent;
            }else if (i === 2){
              $join.value = event.target.parentElement.parentElement.childNodes[i].textContent;
            }
          }
        });
        }else {
          alert("모두 입력해야합니다.");
        }
        

      });
    </script>
  </body>
</html>